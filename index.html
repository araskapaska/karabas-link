<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=5">
  <title>KARABAS</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@7.22.10/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1514528593820-2d192a2b6952?q=80&w=2070&auto=format&fit=crop') no-repeat center center fixed;
      background-size: cover;
      min-height: 100vh;
    }
    .ticket-image {
      background-size: cover;
      background-position: center;
    }
    .barcode {
      background: repeating-linear-gradient(
        90deg,
        #000,
        #000 2px,
        #fff 2px,
        #fff 4px
      );
    }
    @media (max-width: 600px) {
      .ticket-image {
        height: 150px;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    const events = {
      opera: [
        { name: "Игрок", image: "igrok.png", site: null },
        { name: "Золотой петушок", image: "zolotoy_petushok.png", site: null },
        { name: "Сорочинская ярмарка", image: "sorochinskaya_yarmarka.png", site: null },
        { name: "Травиата", image: "traviata.png", site: "https://www.mariinsky.ru" }
      ],
      theater: [
        { name: "Самоубийца", image: "samoubiitsa.png", site: null },
        { name: "Тойбеле и ее демон", image: "toybele_i_ee_demon.png", site: null },
        { name: "Красавица и Чудовище", image: "krasavitsa_i_chudovishche.png", site: null }
      ],
      ballet: [
        { name: "Жар-птица", image: "zharptitsa.png", site: null },
        { name: "Шехеразада", image: "sheherazada.png", site: null },
        { name: "Лебединое озеро", image: "lebedinoe_ozero.png", site: "https://www.bolshoi.ru" },
        { name: "Анюта", image: "anyuta.png", site: null },
        { name: "Журавлиная песнь", image: "zhuravlinaya_pesn.png", site: null }
      ],
      standup: [
        { name: "Женский стендап", image: "zhenskiy_stendap.png", site: "https://standupmoscow.ru" },
        { name: "Стендап в Москве", image: "stendap_v_moskve.png", site: null }
      ],
      exhibition: [
        { name: "Театр балета Эйфмана. Только любовь", image: "teatr_baleta_eifmana_tolko_lyubov.png", site: null },
        { name: "Путь к совершенству", image: "put_k_sovershenstvu.png", site: null },
        { name: "Картинки с выставки", image: "kartinki_s_vystavki.png", site: null }
      ]
    };

    const App = () => {
      const [eventType, setEventType] = useState('');
      const [eventName, setEventName] = useState('');
      const [date, setDate] = useState('');
      const [time, setTime] = useState('');
      const [city, setCity] = useState('');
      const [fullName, setFullName] = useState('');
      const [row, setRow] = useState('1');
      const [seat, setSeat] = useState('1');
      const [price, setPrice] = useState('');
      const [ticketGenerated, setTicketGenerated] = useState(false);
      const [selectedEvent, setSelectedEvent] = useState(null);
      const qrCodeRef = useRef(null);
      const ticketRef = useRef(null);

      const updateEventList = (type) => {
        setEventType(type);
        setEventName('');
      };

      const generateTicket = () => {
        if (!eventType || !eventName || !date || !time || !city || !fullName || !row || !seat || !price) {
          alert('Пожалуйста, заполните все поля!');
          return;
        }
        const event = events[eventType].find(e => e.name === eventName);
        setSelectedEvent(event);
        setTicketGenerated(true);

        if (qrCodeRef.current) {
          qrCodeRef.current.innerHTML = '';
          new QRCode(qrCodeRef.current, {
            text: `FAKE TICKET ${fullName}`,
            width: 80,
            height: 80,
            colorDark: "#000000",
            colorLight: "#ffffff",
            correctLevel: QRCode.CorrectLevel.H
          });
        }
      };

      const goBack = () => {
        setTicketGenerated(false);
        setEventType('');
        setEventName('');
        setDate('');
        setTime('');
        setCity('');
        setFullName('');
        setRow('1');
        setSeat('1');
        setPrice('');
        setSelectedEvent(null);
      };

      const goToEventSite = () => {
        if (selectedEvent && selectedEvent.site) {
          window.open(selectedEvent.site, '_blank');
        } else {
          alert('Сайт для этого мероприятия недоступен.');
        }
      };

      const downloadPNG = () => {
        html2canvas(ticketRef.current).then(canvas => {
          const link = document.createElement('a');
          link.download = 'fake-ticket.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        });
      };

      const downloadPDF = () => {
        html2canvas(ticketRef.current).then(canvas => {
          const imgData = canvas.toDataURL('image/png');
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'px',
            format: [canvas.width, canvas.height]
          });
          pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
          pdf.save('fake-ticket.pdf');
        });
      };

      return (
        <div className="flex flex-col items-center min-h-screen text-white font-sans">
          <h1 className="text-5xl mb-2 text-red-500 drop-shadow-md md:text-4xl">KARABAS</h1>

          {!ticketGenerated && (
            <>
              <div className="bg-gray-800 bg-opacity-90 p-5 rounded-lg w-full max-w-md mb-5 shadow-lg">
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Тип мероприятия</label>
                  <select
                    value={eventType}
                    onChange={(e) => updateEventList(e.target.value)}
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  >
                    <option value="">Выберите тип</option>
                    <option value="opera">Опера</option>
                    <option value="theater">Театр</option>
                    <option value="ballet">Балет</option>
                    <option value="standup">Стендап</option>
                    <option value="exhibition">Выставка</option>
                  </select>
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Выберите название мероприятия</label>
                  <select
                    value={eventName}
                    onChange={(e) => setEventName(e.target.value)}
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  >
                    <option value="">Выберите мероприятие</option>
                    {eventType && events[eventType]?.map(event => (
                      <option key={event.name} value={event.name}>{event.name}</option>
                    ))}
                  </select>
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Дата</label>
                  <input
                    type="date"
                    value={date}
                    onChange={(e) => setDate(e.target.value)}
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  />
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Время</label>
                  <input
                    type="time"
                    value={time}
                    onChange={(e) => setTime(e.target.value)}
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  />
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Город</label>
                  <input
                    type="text"
                    value={city}
                    onChange={(e) => setCity(e.target.value)}
                    placeholder="Город"
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  />
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">ФИО</label>
                  <input
                    type="text"
                    value={fullName}
                    onChange={(e) => setFullName(e.target.value)}
                    placeholder="ФИО"
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  />
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Ряд</label>
                  <select
                    value={row}
                    onChange={(e) => setRow(e.target.value)}
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  >
                    {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(n => (
                      <option key={n} value={n}>{n}</option>
                    ))}
                  </select>
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Место</label>
                  <select
                    value={seat}
                    onChange={(e) => setSeat(e.target.value)}
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  >
                    {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(n => (
                      <option key={n} value={n}>{n}</option>
                    ))}
                  </select>
                </div>
                <div className="mb-4">
                  <label className="block mb-1 text-sm">Стоимость</label>
                  <input
                    type="text"
                    value={price}
                    onChange={(e) => setPrice(e.target.value)}
                    placeholder="Стоимость"
                    className="w-full p-2 bg-gray-700 border border-white text-white rounded text-sm"
                  />
                </div>
                <button
                  onClick={generateTicket}
                  className="w-full p-2 bg-red-600 text-white rounded text-base hover:bg-red-700"
                >
                  Сгенерировать
                </button>
              </div>

              <div className="bg-gray-800 bg-opacity-90 p-4 rounded-lg w-full max-w-md mb-5 shadow-lg text-sm">
                <h3 className="mb-2 text-lg">Политика конфиденциальности</h3>
                <p>
                  Настоящие фейковые билеты созданы исключительно в демонстрационных целях. Мы не собираем,
                  не храним и не передаем персональные данные, введенные в форму, включая имя, город и другие
                  сведения. Все данные остаются на вашем устройстве и используются только для генерации билета.
                  Мы не несем ответственности за использование сгенерированных билетов в реальных мероприятиях,
                  так как они являются фейковыми и не имеют юридической силы. Используйте их на свой страх и риск.
                </p>
              </div>
            </>
          )}

          {ticketGenerated && (
            <>
              <div
                ref={ticketRef}
                className="bg-white text-black p-5 rounded-lg w-full max-w-[500px] mb-5 shadow-lg"
              >
                <div className="flex justify-between items-center mb-5">
                  <h3 className="text-2xl font-bold text-gray-800">KARABAS</h3>
                  <p className="text-xs text-black text-right">
                    ЭЛЕКТРОННЫЙ БИЛЕТ<br />E-ticket #1745515021
                  </p>
                </div>
                <div className="absolute top-5 right-5 text-xs font-bold border border-black px-1 rounded bg-white">
                  18+
                </div>
                <p className="text-2xl font-bold text-gray-800 mb-2 text-center">{eventName}</p>
                <div className="text-center my-2">
                  <div ref={qrCodeRef} className="inline-block w-20 h-20"></div>
                </div>
                <p className="text-base text-black mb-2">{date.split('-').reverse().join('.')}</p>
                <p className="text-base text-black mb-2">{time}</p>
                <div className="w-full h-50 mb-2 ticket-image" style={{ backgroundImage: `url(${selectedEvent?.image})` }}></div>
                <div className="flex justify-between mb-1 flex-col md:flex-row">
                  <div className="w-full md:w-[48%]">
                    <p className="text-sm text-black my-1"><strong>ГОРОД</strong><br />{city}</p>
                    <p className="text-sm text-black my-1">
                      <strong>РЯД, МЕСТО</strong><br />{row} ряд {seat} место
                    </p>
                  </div>
                  <div className="w-full md:w-[48%]">
                    <p className="text-sm text-black my-1"><strong>ФИО</strong><br />{fullName}</p>
                    <p className="text-sm text-black my-1"><strong>НОМЕР ЗАКАЗА #</strong><br />1745515021</p>
                    <p className="text-sm text-black my-1"><strong>СТОИМОСТЬ</strong><br />{price} Р</p>
                  </div>
                </div>
                <div className="w-full h-10 my-1 barcode"></div>
                <div className="border border-black p-2 text-[10px] text-black">
                  <h4 className="mb-1 text-xs font-bold">ПРАВИЛА ИСПОЛЬЗОВАНИЯ И ВОЗВРАТА БИЛЕТА</h4>
                  <p>
                    1. Настоящий электронный билет является равным по консульству мероприятий.<br />
                    2. Указанный идентификатор (штрих-код), содержащий в себе информацию о владельце мероприятия.<br />
                    3. В случае возникновения каких-либо проблем, таких как качество изображения, физическое повреждение.<br />
                    4. Пиротехника запрещена на мероприятии в случае отсутствия технических специалистов.<br />
                    5. Стоимость настоящего электронного билета может быть возвращена по первому требованию.<br />
                    6. С условием обмена вы можете ознакомиться на нашем сайте.
                  </p>
                </div>
              </div>

              <div className="w-full max-w-[500px] mb-5 text-center">
                <button
                  onClick={downloadPNG}
                  className="w-full p-2 bg-red-600 text-white rounded text-base hover:bg-red-700 mb-2"
                >
                  Скачать как PNG
                </button>
                <button
                  onClick={downloadPDF}
                  className="w-full p-2 bg-red-600 text-white rounded text-base hover:bg-red-700"
                >
                  Скачать как PDF
                </button>
              </div>

              <div className="w-full max-w-[500px] mb-5 text-center">
                <button
                  onClick={goBack}
                  className="w-full p-2 bg-gray-700 text-white rounded text-base hover:bg-gray-800 mb-2"
                >
                  Назад
                </button>
                <button
                  onClick={goToEventSite}
                  className="w-full p-2 bg-red-600 text-white rounded text-base hover:bg-red-700"
                >
                  Перейти на сайт мероприятия
                </button>
              </div>

              <div className="bg-gray-800 bg-opacity-90 p-5 rounded-lg w-full max-w-[500px] mb-5 shadow-lg">
                <h3 className="mb-2 text-2xl text-red-500">Другие мероприятия</h3>
                <a href="event-lebedinoe.html" className="flex items-center bg-gray-700 p-2 rounded-lg mb-2 hover:scale-102 transition-transform">
                  <img src="lebedinoe_ozero.png" alt="Лебединое озеро" className="w-[100px] h-[60px] object-cover rounded mr-2" />
                  <div>
                    <h4 className="text-base text-white">Лебединое озеро</h4>
                    <p className="text-xs text-gray-400">30 Апреля 2025, 19:00</p>
                  </div>
                </a>
                <a href="event-traviata.html" className="flex items-center bg-gray-700 p-2 rounded-lg mb-2 hover:scale-102 transition-transform">
                  <img src="traviata.png" alt="Травиата" className="w-[100px] h-[60px] object-cover rounded mr-2" />
                  <div>
                    <h4 className="text-base text-white">Травиата</h4>
                    <p className="text-xs text-gray-400">5 Мая 2025, 18:30</p>
                  </div>
                </a>
                <a href="event-zhenskiy.html" className="flex items-center bg-gray-700 p-2 rounded-lg mb-2 hover:scale-102 transition-transform">
                  <img src="zhenskiy_stendap.png" alt="Женский стендап" className="w-[100px] h-[60px] object-cover rounded mr-2" />
                  <div>
                    <h4 className="text-base text-white">Женский стендап</h4>
                    <p className="text-xs text-gray-400">10 Мая 2025, 20:00</p>
                  </div>
                </a>
              </div>
            </>
          )}

          <footer className="mt-auto p-2 bg-black bg-opacity-50 w-full text-center text-xs text-gray-400">
            <p>
              Все права защищены ООН КАРАБАС, лицензионное соглашение на 2025 год.{' '}
              <a href="license.html" target="_blank" className="text-red-500 hover:underline">
                Подробнее о лицензии
              </a>
            </p>
          </footer>
        </div>
      );
    };

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
